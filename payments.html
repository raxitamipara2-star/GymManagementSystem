<!DOCTYPE html>
<html>
<head>
  <title>Payments</title>
  <link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">
  <style>
    body{font-family:Poppins;background:#f2f4f8;margin:0}
    header{background:#111827;color:white;padding:15px;text-align:center}
    .box{background:white;padding:20px;margin:20px;border-radius:8px}
    input,button{width:100%;padding:12px;margin:10px 0}
    button{background:#111827;color:white;border:none;border-radius:5px;cursor:pointer}
  </style>
</head>
<body>

<header>
  <h2>Record Payment</h2>
</header>

<div class="box">
  <input id="email" type="email" placeholder="Member Email">
  <input id="amount" type="number" placeholder="Amount">
  <button onclick="pay()">Submit Payment</button>
</div>

<script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCux0iKyvFaZ7c8Gc8Tihcl_tULz4vh0Ok",
  authDomain: "gym-management-system-5829d.firebaseapp.com",
  projectId: "gym-management-system-5829d"
});

const auth = firebase.auth();
const db = firebase.firestore();

// Protect page (Admin only)
auth.onAuthStateChanged(user=>{
  if(!user){
    window.location="admin-login.html";
  } else {
    db.collection("users").doc(user.uid).get().then(doc=>{
      if(!doc.exists || doc.data().role!=="admin"){
        alert("Access denied");
        window.location="index.html";
      }
    });
  }
});

function pay(){
  const email = document.getElementById("email").value.trim();
  const amount = document.getElementById("amount").value;

  if(!email || !amount){
    alert("Enter all fields");
    return;
  }

  db.collection("payments").add({
    email: email,
    amount: Number(amount),
    date: firebase.firestore.FieldValue.serverTimestamp()
  })
  .then(()=>{
    alert("Payment saved");
    document.getElementById("email").value="";
    document.getElementById("amount").value="";
  })
  .catch(err=>alert(err.message));
}
</script>

</body>
</html>
